import tt from"./7SFTKAzv.js";import{a as st}from"./DWLJyer9.js";import{_ as et}from"./D23jinLn.js";import{_ as at}from"./DVzLcQHq.js";import{_ as ot}from"./DX-MeMIg.js";import{_ as it}from"./CkhzgGDw.js";import{_ as lt}from"./D9CcJQ6U.js";import{_ as nt}from"./De9WKNiz.js";import{e as dt,p as rt,h,r as O,s as ct,G as ut,c as p,a as t,b as a,w as c,l as e,t as n,k as U,y as mt,F as pt,B as _t,A as vt,i as I,o as m,d as g,j as ft,_ as ht}from"./DwCNKQGy.js";import{u as gt}from"./VxoNYH08.js";import{u as bt}from"./fNtvkFL-.js";import"./8OS6Y6ZV.js";import"./CA11pW0l.js";import"./SypB52A4.js";import"./9DPBaL4s.js";import"./DLa_3Mil.js";import"./DoM2d5B8.js";import"./CMcnA0-p.js";import"./f_Zdffto.js";const Et={class:"admin-priest-panel"},Vt={class:"panel-header"},wt={class:"header-content"},Rt={class:"header-title"},St={class:"header-actions"},yt={class:"filters-section"},Dt={class:"filters-row"},Ut={class:"stats-grid"},Ct={class:"stat-card"},Nt={class:"stat-icon pending"},At={class:"stat-content"},Pt={class:"stat-number"},kt={class:"stat-card"},Ot={class:"stat-icon review"},It={class:"stat-content"},xt={class:"stat-number"},Tt={class:"stat-card"},zt={class:"stat-icon approved"},Bt={class:"stat-content"},Mt={class:"stat-number"},jt={class:"stat-card"},$t={class:"stat-icon rejected"},Ft={class:"stat-content"},Gt={class:"stat-number"},qt={class:"table-section"},Jt={class:"table-header"},Lt={key:0,class:"pagination-info"},Wt={key:0,class:"loading-state"},Qt={key:1,class:"empty-state"},Ht={key:2,class:"registrations-table"},Kt={class:"table-cell"},Xt={class:"priest-info"},Yt={class:"priest-name"},Zt={class:"priest-details"},ts={class:"table-cell"},ss={class:"email-info"},es={class:"table-cell"},as={class:"table-cell"},os={class:"table-cell"},is={class:"date-info"},ls={class:"date-time"},ns={class:"table-cell"},ds={class:"actions-menu"},rs={key:3,class:"pagination-section"},cs={class:"modal-content"},us={class:"modal-header"},ms={class:"modal-body"},ps={class:"priest-summary"},_s={class:"modal-actions"},vs=dt({__name:"index",setup(fs){rt({title:"Painel Administrativo - Cadastro de Padres",description:"Gerencie e aprove cadastros de padres na plataforma AcessoCatólico."});const{getRegistrations:b,updateStatus:x,formatStatus:T,getStatusColor:z}=gt(),R=bt(),S=h(!1),y=h(!1),w=h(!1),_=h(1),D=h([]),d=h(null),E=h({pending:0,underReview:0,approved:0,rejected:0}),u=O({search:"",status:""}),l=O({isOpen:!1,registration:null,newStatus:"",comments:""}),B=[{label:"Todos os status",value:""},{label:"Pendente",value:"PENDING"},{label:"Em Análise",value:"UNDER_REVIEW"},{label:"Aprovado",value:"APPROVED"},{label:"Rejeitado",value:"REJECTED"},{label:"Requer Documentação",value:"REQUIRES_DOCUMENTATION"}],M=[{label:"Em Análise",value:"UNDER_REVIEW"},{label:"Aprovar",value:"APPROVED"},{label:"Rejeitar",value:"REJECTED"},{label:"Solicitar Documentação",value:"REQUIRES_DOCUMENTATION"}],v=async()=>{S.value=!0;try{const o={page:_.value,limit:10};u.status&&(o.status=u.status),u.search.trim()&&(o.search=u.search.trim());const s=await b(o);D.value=s.registrations,d.value=s.pagination,j()}catch(o){R.add({title:"Erro ao carregar dados",description:o.message,color:"ui"})}finally{S.value=!1}},j=async()=>{try{const[o,s,r,f]=await Promise.all([b({status:"PENDING",limit:1}),b({status:"UNDER_REVIEW",limit:1}),b({status:"APPROVED",limit:1}),b({status:"REJECTED",limit:1})]);E.value={pending:o.pagination.total,underReview:s.pagination.total,approved:r.pagination.total,rejected:f.pagination.total}}catch(o){console.error("Error updating stats:",o)}},$=async()=>{y.value=!0;try{await v()}finally{y.value=!1}},F=useDebounceFn(()=>{_.value=1,v()},500),G=o=>{_.value=o,v()},q=o=>{l.registration=o,l.newStatus="",l.comments="",l.isOpen=!0},J=async()=>{if(!(!l.registration||!l.newStatus)){w.value=!0;try{await x(l.registration.id,l.newStatus,l.comments||void 0,"admin@acessocatolico.com"),R.add({title:"Status atualizado",description:"O status do cadastro foi atualizado com sucesso.",color:"primary"}),l.isOpen=!1,await v()}catch(o){R.add({title:"Erro ao atualizar",description:o.message,color:"ui"})}finally{w.value=!1}}},L=o=>[[{label:"Ver Detalhes",icon:"heroicons:eye",click:()=>{console.log("View details:",o.id)}}],[{label:"Atualizar Status",icon:"heroicons:pencil-square",click:()=>q(o)}]],W=o=>new Date(o).toLocaleDateString("pt-BR"),Q=o=>new Date(o).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});return ct(()=>{v()}),ut(()=>u.status,()=>{_.value=1,v()}),(o,s)=>{const r=tt,f=st,H=et,C=at,N=ot,K=I("UDropdown"),X=it,A=I("UFormGroup"),Y=lt,Z=nt;return m(),p("div",Et,[t("div",Vt,[t("div",wt,[t("div",Rt,[a(r,{name:"heroicons:users",class:"header-icon"}),s[8]||(s[8]=t("div",null,[t("h1",null,"Gerenciamento de Padres"),t("p",null,"Visualize e gerencie os cadastros de padres pendentes")],-1))]),t("div",St,[a(f,{onClick:$,loading:e(y),variant:"outline"},{default:c(()=>[a(r,{name:"heroicons:arrow-path"}),s[9]||(s[9]=g(" Atualizar "))]),_:1,__:[9]},8,["loading"])])])]),t("div",yt,[t("div",Dt,[a(H,{modelValue:e(u).search,"onUpdate:modelValue":s[0]||(s[0]=i=>e(u).search=i),placeholder:"Buscar por nome, email ou CPF...",icon:"heroicons:magnifying-glass",class:"search-input",onInput:e(F)},null,8,["modelValue","onInput"]),a(C,{modelValue:e(u).status,"onUpdate:modelValue":[s[1]||(s[1]=i=>e(u).status=i),v],options:B,placeholder:"Todos os status",class:"status-filter"},null,8,["modelValue"])])]),t("div",Ut,[t("div",Ct,[t("div",Nt,[a(r,{name:"heroicons:clock"})]),t("div",At,[t("div",Pt,n(e(E).pending),1),s[10]||(s[10]=t("div",{class:"stat-label"},"Pendentes",-1))])]),t("div",kt,[t("div",Ot,[a(r,{name:"heroicons:eye"})]),t("div",It,[t("div",xt,n(e(E).underReview),1),s[11]||(s[11]=t("div",{class:"stat-label"},"Em Análise",-1))])]),t("div",Tt,[t("div",zt,[a(r,{name:"heroicons:check-circle"})]),t("div",Bt,[t("div",Mt,n(e(E).approved),1),s[12]||(s[12]=t("div",{class:"stat-label"},"Aprovados",-1))])]),t("div",jt,[t("div",$t,[a(r,{name:"heroicons:x-circle"})]),t("div",Ft,[t("div",Gt,n(e(E).rejected),1),s[13]||(s[13]=t("div",{class:"stat-label"},"Rejeitados",-1))])])]),t("div",qt,[t("div",Jt,[s[14]||(s[14]=t("h2",null,"Cadastros Recentes",-1)),e(d)?(m(),p("div",Lt," Mostrando "+n((e(d).page-1)*e(d).limit+1)+" a "+n(Math.min(e(d).page*e(d).limit,e(d).total))+" de "+n(e(d).total)+" registros ",1)):U("",!0)]),e(S)?(m(),p("div",Wt,[a(r,{name:"heroicons:arrow-path",class:"loading-icon"}),s[15]||(s[15]=t("p",null,"Carregando cadastros...",-1))])):e(D).length===0?(m(),p("div",Qt,[a(r,{name:"heroicons:document-text",class:"empty-icon"}),s[16]||(s[16]=t("h3",null,"Nenhum cadastro encontrado",-1)),s[17]||(s[17]=t("p",null,"Não há cadastros que correspondam aos filtros selecionados.",-1))])):(m(),p("div",Ht,[s[19]||(s[19]=mt('<div class="table-header-row" data-v-8251081e><div class="table-cell" data-v-8251081e>Padre</div><div class="table-cell" data-v-8251081e>Email</div><div class="table-cell" data-v-8251081e>Diocese</div><div class="table-cell" data-v-8251081e>Status</div><div class="table-cell" data-v-8251081e>Data</div><div class="table-cell" data-v-8251081e>Ações</div></div>',1)),(m(!0),p(pt,null,_t(e(D),i=>(m(),p("div",{key:i.id,class:"table-row"},[t("div",Kt,[t("div",Xt,[t("div",Yt,n(i.firstName)+" "+n(i.lastName),1),t("div",Zt," CPF: "+n(i.cpf),1)])]),t("div",ts,[t("div",ss,[g(n(i.email)+" ",1),i.emailVerified?(m(),ft(N,{key:0,size:"xs",color:"primary"},{default:c(()=>s[18]||(s[18]=[g(" Verificado ")])),_:1,__:[18]})):U("",!0)])]),t("div",es,n(i.ordinationDiocese.name),1),t("div",as,[a(N,{color:e(z)(i.status),variant:"soft"},{default:c(()=>[g(n(e(T)(i.status)),1)]),_:2},1032,["color"])]),t("div",os,[t("div",is,[t("div",null,n(W(i.createdAt)),1),t("div",ls,n(Q(i.createdAt)),1)])]),t("div",ns,[t("div",ds,[a(K,{items:L(i)},{default:c(()=>[a(f,{variant:"ghost",size:"sm"},{default:c(()=>[a(r,{name:"heroicons:ellipsis-horizontal"})]),_:1})]),_:2},1032,["items"])])])]))),128))])),e(d)&&e(d).totalPages>1?(m(),p("div",rs,[a(X,{modelValue:e(_),"onUpdate:modelValue":[s[2]||(s[2]=i=>vt(_)?_.value=i:null),G],"page-count":e(d).limit,total:e(d).total},null,8,["modelValue","page-count","total"])])):U("",!0)]),a(Z,{modelValue:e(l).isOpen,"onUpdate:modelValue":s[7]||(s[7]=i=>e(l).isOpen=i),ui:{width:"sm:max-w-md"}},{default:c(()=>{var i,P,k;return[t("div",cs,[t("div",us,[s[20]||(s[20]=t("h3",null,"Atualizar Status",-1)),a(f,{onClick:s[3]||(s[3]=V=>e(l).isOpen=!1),variant:"ghost",size:"sm"},{default:c(()=>[a(r,{name:"heroicons:x-mark"})]),_:1})]),t("div",ms,[t("div",ps,[t("h4",null,n((i=e(l).registration)==null?void 0:i.firstName)+" "+n((P=e(l).registration)==null?void 0:P.lastName),1),t("p",null,n((k=e(l).registration)==null?void 0:k.email),1)]),a(A,{label:"Novo Status",required:""},{default:c(()=>[a(C,{modelValue:e(l).newStatus,"onUpdate:modelValue":s[4]||(s[4]=V=>e(l).newStatus=V),options:M,placeholder:"Selecione o status"},null,8,["modelValue"])]),_:1}),a(A,{label:"Comentários"},{default:c(()=>[a(Y,{modelValue:e(l).comments,"onUpdate:modelValue":s[5]||(s[5]=V=>e(l).comments=V),placeholder:"Comentários sobre a decisão (opcional)",rows:3},null,8,["modelValue"])]),_:1})]),t("div",_s,[a(f,{onClick:s[6]||(s[6]=V=>e(l).isOpen=!1),variant:"outline",disabled:e(w)},{default:c(()=>s[21]||(s[21]=[g(" Cancelar ")])),_:1,__:[21]},8,["disabled"]),a(f,{onClick:J,loading:e(w),disabled:!e(l).newStatus},{default:c(()=>s[22]||(s[22]=[g(" Atualizar Status ")])),_:1,__:[22]},8,["loading","disabled"])])])]}),_:1},8,["modelValue"])])}}}),Ts=ht(vs,[["__scopeId","data-v-8251081e"]]);export{Ts as default};
