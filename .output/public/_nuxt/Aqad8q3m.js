import{c0 as I,C as E,a1 as c,O as d}from"./CuMR5YMQ.js";const M=I((R,u)=>{const{user:t}=E();if(!t.value)return c("/login");const i={ADMIN:["ADMIN","PRIEST","ORGANIZER","MEMBER","VISITOR"],PRIEST:["PRIEST","ORGANIZER","MEMBER","VISITOR"],ORGANIZER:["ORGANIZER","MEMBER","VISITOR"],MEMBER:["MEMBER","VISITOR"],VISITOR:["VISITOR"]},o={"/admin":["ADMIN"],"/dashboard/admin":["ADMIN"],"/dashboard/priest":["PRIEST"],"/dashboard/organizer":["ORGANIZER"],"/parishes/manage":["PRIEST"],"/events/create":["ORGANIZER"],"/events/manage":["ORGANIZER"],"/ministries/manage":["ORGANIZER"],"/schedules/manage":["ORGANIZER"]},r=R.path;let e=o[r];if(!e){for(const[s,a]of Object.entries(o))if(r.startsWith(s)){e=a;break}}if(e){const s=t.value.role,a=i[s]||[s];if(!e.some(n=>a.includes(n)))throw d({statusCode:403,statusMessage:"Acesso negado - PermissÃµes insuficientes"})}});export{M as default};
