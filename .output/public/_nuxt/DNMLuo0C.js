import{_ as E,b as C}from"./XrZAkBch.js";import{_ as T}from"./CZSs4om5.js";import{e as z,T as B,u as R,f as S,F as d,g as j,c as u,a as e,b as t,w as i,o as m,k as r,t as b,d as f,R as q}from"./DOw91aXk.js";import{u as N}from"./YdcuF5yM.js";import"./Cu5UbMqw.js";import"./BzWLyf5Z.js";import"./BIsvGA9u.js";const P={class:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center p-4"},$={class:"max-w-md w-full"},L={key:0,class:"text-center py-8"},U={key:1,class:"text-center py-8"},A={class:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center"},H={class:"text-gray-600 mb-6"},I={class:"space-y-3"},M={key:2,class:"text-center py-8"},O={class:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center"},D={class:"text-gray-600 mb-6"},F={class:"space-y-3"},ee=z({__name:"verificar-email",setup(G){const h=B(),l=N();R({title:"Verificação de Email - AcessoCatólico",meta:[{name:"description",content:"Verificação de email para cadastro de padre"}]});const p=S(()=>h.query.token),v=d(!1),x=d(!1),n=d(null),o=d(null);j(async()=>{if(!p.value){o.value={message:"Token de verificação não fornecido"};return}await w()});async function w(){if(p.value){v.value=!0,o.value=null,n.value=null;try{const{data:a}=await $fetch("/api/priests/verify-email",{method:"POST",body:{token:p.value}});n.value=a,l.add({title:"Email verificado!",description:"Seu cadastro está agora em análise.",color:"green"})}catch(a){console.error("Email verification error:",a),o.value=a.data||{message:"Erro desconhecido"},l.add({title:"Erro na verificação",description:o.value.message,color:"red"})}finally{v.value=!1}}}async function k(){x.value=!0;try{l.add({title:"Email reenviado!",description:"Verifique sua caixa de entrada.",color:"green"}),await q("/cadastro/padre/verificar-email-enviado")}catch(a){console.error("Resend verification error:",a),l.add({title:"Erro ao reenviar",description:"Tente novamente mais tarde.",color:"red"})}finally{x.value=!1}}return(a,s)=>{const g=E,c=C,V=T;return m(),u("div",P,[e("div",$,[t(V,{class:"shadow-xl"},{default:i(()=>{var _,y;return[r(v)?(m(),u("div",L,s[0]||(s[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4"},[e("svg",{class:"animate-spin w-full h-full text-purple-600",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})])],-1),e("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Verificando email...",-1),e("p",{class:"text-gray-600"},"Por favor, aguarde enquanto confirmamos seu email.",-1)]))):(_=r(n))!=null&&_.success?(m(),u("div",U,[e("div",A,[t(g,{name:"i-heroicons-check-circle",class:"w-8 h-8 text-green-600"})]),s[3]||(s[3]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Email verificado com sucesso!",-1)),e("p",H,b(r(n).message),1),s[4]||(s[4]=e("div",{class:"bg-blue-50 rounded-lg p-4 mb-6 text-left"},[e("h3",{class:"font-medium text-blue-900 mb-2"},"Próximos passos:"),e("ul",{class:"text-sm text-blue-800 space-y-1"},[e("li",null,"• Seu cadastro está agora em análise"),e("li",null,"• Nossa equipe analisará em 2-3 dias úteis"),e("li",null,"• Você receberá um email com o resultado")])],-1)),e("div",I,[t(c,{to:"/",size:"lg",class:"w-full",icon:"i-heroicons-home"},{default:i(()=>s[1]||(s[1]=[f(" Voltar ao Início ")])),_:1,__:[1]}),t(c,{to:"/cadastro/padre/status",variant:"outline",size:"lg",class:"w-full",icon:"i-heroicons-magnifying-glass"},{default:i(()=>s[2]||(s[2]=[f(" Consultar Status ")])),_:1,__:[2]})])])):(m(),u("div",M,[e("div",O,[t(g,{name:"i-heroicons-x-circle",class:"w-8 h-8 text-red-600"})]),s[7]||(s[7]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-2"},"Erro na verificação",-1)),e("p",D,b(((y=r(o))==null?void 0:y.message)||"Ocorreu um erro ao verificar seu email."),1),s[8]||(s[8]=e("div",{class:"bg-yellow-50 rounded-lg p-4 mb-6 text-left"},[e("h3",{class:"font-medium text-yellow-900 mb-2"},"Possíveis causas:"),e("ul",{class:"text-sm text-yellow-800 space-y-1"},[e("li",null,"• Link de verificação expirado (24 horas)"),e("li",null,"• Link já foi usado anteriormente"),e("li",null,"• Link inválido ou corrompido")])],-1)),e("div",F,[t(c,{onClick:k,loading:r(x),size:"lg",class:"w-full",icon:"i-heroicons-envelope"},{default:i(()=>s[5]||(s[5]=[f(" Reenviar Email de Verificação ")])),_:1,__:[5]},8,["loading"]),t(c,{to:"/cadastro/padre",variant:"outline",size:"lg",class:"w-full",icon:"i-heroicons-arrow-left"},{default:i(()=>s[6]||(s[6]=[f(" Voltar ao Cadastro ")])),_:1,__:[6]})])]))]}),_:1})])])}}});export{ee as default};
