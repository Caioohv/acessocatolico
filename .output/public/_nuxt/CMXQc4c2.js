import J from"./DcD60dw0.js";import{a as K}from"./BtdOvfXc.js";import{_ as Q}from"./Bd5iK0Qo.js";import{_ as W}from"./D6cRczWY.js";import{_ as X}from"./qKtb0dX2.js";import{_ as Y}from"./B3ORKnUs.js";import{_ as Z}from"./D1kZC3JJ.js";import{u as oo}from"./Ba4-aC7x.js";import{u as eo}from"./BpxGMsj-.js";import{h,D as to,G as so,s as ao,c as v,a as e,b as a,w as u,l as r,k as D,F as $,B as V,j as x,t as d,i as ro,o as m,d as f,C as _}from"./wPnuorX7.js";import"./CMLLu8c2.js";import"./C4sSfo7S.js";import"./CQ8b8sfu.js";import"./CryAMGYs.js";import"./Dm6-dgtR.js";import"./BKhI9f09.js";import"./BeGsyJa-.js";import"./Dw2envGg.js";const no={class:"min-h-screen bg-gray-50"},lo={class:"bg-white border-b border-gray-200"},io={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},co={class:"flex items-center justify-between py-6"},mo={class:"flex items-center space-x-3"},uo={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},po={class:"bg-white rounded-lg border border-gray-200 p-4 mb-6"},fo={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},vo={class:"flex items-end"},go={key:0,class:"space-y-4"},_o={key:1,class:"text-center py-12 bg-white rounded-lg border border-gray-200"},bo={class:"text-gray-600 mb-6"},ho={key:2,class:"space-y-4"},xo={class:"flex items-start justify-between"},yo={class:"flex-1 min-w-0"},wo={class:"flex items-center space-x-3 mb-2"},Eo={class:"text-lg font-semibold text-gray-900 truncate"},ko={class:"text-gray-600 text-sm mb-3 line-clamp-2"},So={class:"flex items-center space-x-6 text-sm text-gray-500"},Co={class:"flex items-center space-x-1"},Do={class:"flex items-center space-x-1"},Fo={key:0,class:"flex items-center space-x-1"},Lo={class:"flex items-center space-x-2 ml-4"},Uo={key:3,class:"mt-8 flex items-center justify-between"},$o={class:"text-sm text-gray-700"},Yo={__name:"index",setup(Vo){const{showToast:b}=oo(),{createEventForm:A}=eo(),y=h(!0),k=h(null),w=h([]),l=h({search:"",status:"",formStatus:""}),i=h({page:1,limit:10,total:0}),T=[{value:"",label:"Todos os status"},{value:"DRAFT",label:"Rascunho"},{value:"PUBLISHED",label:"Publicado"},{value:"CANCELLED",label:"Cancelado"},{value:"COMPLETED",label:"Finalizado"}],B=[{value:"",label:"Todos"},{value:"with_form",label:"Com formulário"},{value:"without_form",label:"Sem formulário"},{value:"active_form",label:"Formulário ativo"},{value:"inactive_form",label:"Formulário inativo"}],F=to(()=>l.value.search||l.value.status||l.value.formStatus),P=useDebounceFn(()=>{i.value.page=1,g()},300);async function g(){try{y.value=!0;const t=new URLSearchParams({page:i.value.page.toString(),limit:i.value.limit.toString()});l.value.search&&t.append("search",l.value.search),l.value.status&&t.append("status",l.value.status),l.value.formStatus&&t.append("formStatus",l.value.formStatus);const{data:o}=await $fetch(`/api/admin/events?${t}`);w.value=o.events,i.value.total=o.total}catch(t){console.error("Error loading events:",t),b("Erro ao carregar eventos","error")}finally{y.value=!1}}function R(t){return[[{label:"Ver evento",icon:"heroicons:eye",click:()=>_(`/eventos/${t.slug}`)}],[{label:"Editar evento",icon:"heroicons:pencil",click:()=>_(`/eventos/${t.slug}/editar`)}],[{label:"Ver inscrições",icon:"heroicons:users",click:()=>_(`/admin/eventos/${t.id}/inscricoes`),disabled:!t.form}]]}function N(t){return[[{label:"Configurar formulário",icon:"heroicons:cog-6-tooth",click:()=>_(`/admin/eventos/${t.id}/formulario`)}],[{label:"Ver inscrições",icon:"heroicons:users",click:()=>_(`/admin/eventos/${t.id}/inscricoes`)}],[{label:"Exportar inscrições",icon:"heroicons:arrow-down-tray",click:()=>I(t.id)}]]}async function j(t){try{k.value=t,(await A(t,{title:"Formulário de Inscrição",isActive:!1})).success&&(b("Formulário criado com sucesso!","success"),await g(),_(`/admin/eventos/${t}/formulario`))}catch(o){console.error("Error creating form:",o),b("Erro ao criar formulário","error")}finally{k.value=null}}async function I(t){try{const o=await $fetch(`/api/events/${t}/form/export`,{method:"GET"}),n=new Blob([o],{type:"text/csv"}),c=window.URL.createObjectURL(n),p=document.createElement("a");p.href=c,p.download=`inscricoes-evento-${t}.csv`,document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(c),b("Arquivo exportado com sucesso!","success")}catch(o){console.error("Error exporting submissions:",o),b("Erro ao exportar inscrições","error")}}function M(t){return{DRAFT:"yellow",PUBLISHED:"green",CANCELLED:"red",COMPLETED:"blue"}[t]||"gray"}function O(t){return{DRAFT:"Rascunho",PUBLISHED:"Publicado",CANCELLED:"Cancelado",COMPLETED:"Finalizado"}[t]||t}function z(t,o){const n=new Date(t),c=o?new Date(o):null,p=E=>E.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"});return c&&n.toDateString()!==c.toDateString()?`${p(n)} - ${p(c)}`:p(n)}function G(){g()}function H(){l.value={search:"",status:"",formStatus:""},i.value.page=1,g()}return so(()=>[l.value.status,l.value.formStatus],()=>{i.value.page=1,g()}),ao(()=>{g()}),(t,o)=>{const n=J,c=K,p=Q,E=W,S=X,C=Y,L=ro("UDropdown"),q=Z;return m(),v("div",no,[e("div",lo,[e("div",io,[e("div",co,[o[6]||(o[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"}," Administração de Eventos "),e("p",{class:"text-sm text-gray-600 mt-1"}," Gerencie eventos e seus formulários de inscrição ")],-1)),e("div",mo,[a(c,{variant:"outline",color:"gray",onClick:G,loading:r(y)},{default:u(()=>[a(n,{name:"heroicons:arrow-path",class:"h-4 w-4 mr-2"}),o[4]||(o[4]=f(" Atualizar "))]),_:1,__:[4]},8,["loading"]),a(c,{color:"primary",to:"/eventos/criar"},{default:u(()=>[a(n,{name:"heroicons:plus",class:"h-4 w-4 mr-2"}),o[5]||(o[5]=f(" Novo Evento "))]),_:1,__:[5]})])])])]),e("div",uo,[e("div",po,[e("div",fo,[e("div",null,[o[7]||(o[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Buscar eventos ",-1)),a(p,{modelValue:r(l).search,"onUpdate:modelValue":o[0]||(o[0]=s=>r(l).search=s),placeholder:"Nome, descrição...",icon:"heroicons:magnifying-glass",onInput:r(P)},null,8,["modelValue","onInput"])]),e("div",null,[o[8]||(o[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Status do evento ",-1)),a(E,{modelValue:r(l).status,"onUpdate:modelValue":o[1]||(o[1]=s=>r(l).status=s),options:T,placeholder:"Todos os status"},null,8,["modelValue"])]),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Formulário ",-1)),a(E,{modelValue:r(l).formStatus,"onUpdate:modelValue":o[2]||(o[2]=s=>r(l).formStatus=s),options:B,placeholder:"Todos"},null,8,["modelValue"])]),e("div",vo,[a(c,{variant:"outline",color:"gray",onClick:H,class:"w-full"},{default:u(()=>[a(n,{name:"heroicons:x-mark",class:"h-4 w-4 mr-2"}),o[10]||(o[10]=f(" Limpar filtros "))]),_:1,__:[10]})])])]),r(y)?(m(),v("div",go,[(m(),v($,null,V(3,s=>e("div",{key:s,class:"bg-white rounded-lg border border-gray-200 p-6"},[a(S,{class:"h-6 w-1/3 mb-3"}),a(S,{class:"h-4 w-2/3 mb-2"}),a(S,{class:"h-4 w-1/2"})])),64))])):r(w).length===0?(m(),v("div",_o,[a(n,{name:"heroicons:calendar-days",class:"h-12 w-12 mx-auto mb-4 text-gray-300"}),o[12]||(o[12]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Nenhum evento encontrado",-1)),e("p",bo,d(r(F)?"Tente ajustar os filtros de busca":"Comece criando seu primeiro evento"),1),r(F)?D("",!0):(m(),x(c,{key:0,color:"primary",to:"/eventos/criar"},{default:u(()=>[a(n,{name:"heroicons:plus",class:"h-4 w-4 mr-2"}),o[11]||(o[11]=f(" Criar Evento "))]),_:1,__:[11]}))])):(m(),v("div",ho,[(m(!0),v($,null,V(r(w),s=>{var U;return m(),v("div",{key:s.id,class:"bg-white rounded-lg border border-gray-200 p-6 hover:border-blue-300 transition-colors"},[e("div",xo,[e("div",yo,[e("div",wo,[e("h3",Eo,d(s.title),1),a(C,{color:M(s.status),variant:"subtle"},{default:u(()=>[f(d(O(s.status)),1)]),_:2},1032,["color"]),s.form?(m(),x(C,{key:0,color:s.form.isActive?"green":"gray",variant:"subtle"},{default:u(()=>[a(n,{name:s.form.isActive?"heroicons:check-circle":"heroicons:x-circle",class:"h-3 w-3 mr-1"},null,8,["name"]),f(" "+d(s.form.isActive?"Form Ativo":"Form Inativo"),1)]),_:2},1032,["color"])):(m(),x(C,{key:1,color:"yellow",variant:"subtle"},{default:u(()=>[a(n,{name:"heroicons:exclamation-triangle",class:"h-3 w-3 mr-1"}),o[13]||(o[13]=f(" Sem formulário "))]),_:1,__:[13]}))]),e("p",ko,d(s.description),1),e("div",So,[e("div",Co,[a(n,{name:"heroicons:calendar-days",class:"h-4 w-4"}),e("span",null,d(z(s.startDate,s.endDate)),1)]),e("div",Do,[a(n,{name:"heroicons:map-pin",class:"h-4 w-4"}),e("span",null,d(s.location||"Local não definido"),1)]),s.maxParticipants?(m(),v("div",Fo,[a(n,{name:"heroicons:users",class:"h-4 w-4"}),e("span",null,d(((U=s._count)==null?void 0:U.registrations)||0)+"/"+d(s.maxParticipants)+" inscritos",1)])):D("",!0)])]),e("div",Lo,[s.form?(m(),x(L,{key:0,items:N(s),popper:{placement:"bottom-end"}},{default:u(()=>[a(c,{variant:"outline",color:"blue","trailing-icon":"heroicons:chevron-down-20-solid"},{default:u(()=>[a(n,{name:"heroicons:document-text",class:"h-4 w-4 mr-2"}),o[14]||(o[14]=f(" Formulário "))]),_:1,__:[14]})]),_:2},1032,["items"])):(m(),x(c,{key:1,variant:"outline",color:"blue",onClick:Ao=>j(s.id),loading:r(k)===s.id},{default:u(()=>[a(n,{name:"heroicons:plus",class:"h-4 w-4 mr-2"}),o[15]||(o[15]=f(" Criar Formulário "))]),_:2,__:[15]},1032,["onClick","loading"])),a(L,{items:R(s),popper:{placement:"bottom-end"}},{default:u(()=>[a(c,{variant:"outline",color:"gray","trailing-icon":"heroicons:chevron-down-20-solid"},{default:u(()=>[a(n,{name:"heroicons:cog-6-tooth",class:"h-4 w-4 mr-2"}),o[16]||(o[16]=f(" Ações "))]),_:1,__:[16]})]),_:2},1032,["items"])])])])}),128))])),r(w).length>0?(m(),v("div",Uo,[e("div",$o," Mostrando "+d((r(i).page-1)*r(i).limit+1)+" até "+d(Math.min(r(i).page*r(i).limit,r(i).total))+" de "+d(r(i).total)+" eventos ",1),a(q,{modelValue:r(i).page,"onUpdate:modelValue":[o[3]||(o[3]=s=>r(i).page=s),g],"page-count":r(i).limit,total:r(i).total},null,8,["modelValue","page-count","total"])])):D("",!0)])])}}};export{Yo as default};
